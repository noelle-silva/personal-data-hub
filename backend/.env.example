# ============================================================
# Personal Data Hub (Backend) - .env Example
#
# 用法：
# 1) 复制本文件为 `backend/.env`
# 2) 按需修改配置
#
# 约定：
# - 后端只读取这个文件：backend/.env
# ============================================================

# =========================
# 服务端口与运行环境
# =========================
BACKEND_PORT=5000
NODE_ENV=development

# 可选：全局请求体大小（express json/urlencoded limit）
MAX_REQUEST_BODY_SIZE=10mb


# =========================
# MongoDB
# =========================
MONGODB_URI=mongodb://username:password@localhost:27017/personal-data-hub?authSource=admin

# 集合名称（可选）
DOCUMENT_COLLECTION=documents
QUOTE_COLLECTION=quotes
ATTACHMENT_COLLECTION=attachments
CUSTOM_PAGE_COLLECTION=custom-pages

AI_PROMPTS_COLLECTION=AI-prompts
AI_ROLES_COLLECTION=AI-roles
AI_CHAT_HISTORY_COLLECTION=ai-chat-history


# =========================
# 附件系统
# =========================

# 存储路径（支持绝对路径或相对项目根目录的相对路径）
ATTACHMENTS_BASE_DIR=backend/attachments
ATTACHMENTS_TMP_DIR=backend/attachments/tmp

ATTACHMENTS_IMAGE_DIR=backend/attachments/images
ATTACHMENTS_VIDEO_DIR=backend/attachments/videos
ATTACHMENTS_FILE_DIR=backend/attachments/document-file
ATTACHMENTS_SCRIPT_DIR=backend/attachments/scripts

# 图片上传限制
ATTACHMENTS_MAX_IMAGE_SIZE=10485760
ATTACHMENTS_ALLOWED_IMAGE_TYPES=image/png,image/jpeg,image/webp,image/gif

# 视频上传限制
ATTACHMENTS_MAX_VIDEO_SIZE=1073741824
ATTACHMENTS_ALLOWED_VIDEO_TYPES=video/mp4,video/webm,video/ogg,video/quicktime,video/x-msvideo,video/x-matroska,video/x-flv

# 文档上传限制
ATTACHMENTS_MAX_DOCUMENT_SIZE=52428800
ATTACHMENTS_ALLOWED_DOCUMENT_TYPES=application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/epub+zip,application/epub

# 程序与脚本上传限制
ATTACHMENTS_MAX_SCRIPT_SIZE=10485760
ATTACHMENTS_ALLOWED_SCRIPT_TYPES=text/x-python,application/x-msdos-program,text/x-shellscript,application/javascript,text/x-c++src,application/x-msdownload,text/javascript

# 去重策略（true/false）
ATTACHMENTS_ENABLE_DEDUPLICATION=false

# 缓存（秒）
ATTACHMENTS_CACHE_TTL=3600

# Range 支持（用于视频分段加载）
ATTACHMENTS_ENABLE_RANGE=true

# 多文件上传数量限制（按类别）
ATTACHMENTS_MAX_IMAGE_FILES=10
ATTACHMENTS_MAX_VIDEO_FILES=3
ATTACHMENTS_MAX_DOCUMENT_FILES=10
ATTACHMENTS_MAX_SCRIPT_FILES=10

# 可选：签名链接/鉴权（桌面端/开发环境可先留空）
ATTACHMENTS_SECRET=
ATTACHMENTS_BEARER_TOKEN=
ATTACHMENTS_SIGNED_URL_TTL=3600


# =========================
# 登录认证
# =========================
LOGIN_USERNAME=admin
LOGIN_PASSWORD_HASH=your-bcrypt-password-hash-here

JWT_SECRET=your-jwt-secret-key-change-this-in-production
JWT_EXPIRES_IN=24h

# 可选：滑动刷新窗口（秒）
JWT_REFRESH_WINDOW_SECONDS=3600

# 可选：refresh token TTL（秒），默认 30 天
REFRESH_TOKEN_TTL_SECONDS=2592000

# 管理员用户ID（24位十六进制 ObjectId 字符串）
ADMIN_USER_ID=000000000000000000000001

# 登录限流（桌面端默认建议关闭）
LOGIN_RATE_LIMIT_ENABLED=false


# =========================
# 壁纸/主题（可选）
# =========================
WALLPAPER_ALLOWED_TYPES=image/jpeg,image/png,image/webp
WALLPAPER_MAX_SIZE=10485760

THEME_COLOR_PRIMARY_MIN_SHARE=0.18
THEME_COLOR_MIN_SATURATION=0.28
THEME_COLOR_CLUSTER_K=128
THEME_COLOR_TINT_MAX_LIGHT=0.02
THEME_COLOR_TINT_MAX_DARK=0.04
THEME_COLOR_NEUTRAL_SAT_THRESHOLD=0.08
THEME_COLOR_NEUTRAL_SHARE=0.6
THEME_COLOR_MIN_HUE_DISTANCE=30
THEME_COLOR_TOPN_DIAGNOSTICS=8


# =========================
# 调试开关（可选）
# =========================
DEBUG_EPHEMERAL_INJECTION=false
DEBUG_SYSTEM_PROMPT=false
